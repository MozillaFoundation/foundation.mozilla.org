#!/usr/bin/env bash

set -euo pipefail

cd ${BUILD_DIR}

# Get the po files from S3
curl -o translations.tar https://foundation-site-translations.s3.amazonaws.com/translations.tar

# Untar the archive
tar xvf translations.tar

# Copy the latest Portuguese (Brazil) file translated from Pontoon into the folder consumed by Django
ptSourceDjango=${BUILD_DIR}/network-api/locale/pt_BR/LC_MESSAGES/django.*
[[ -e ${ptSourceDjango} ]] && cp ${ptSourceDjango} ${BUILD_DIR}/network-api/locale/pt/LC_MESSAGES/django.*

# Same for Buyers Guide
ptSourceBuyersguide=${BUILD_DIR}/network-api/networkapi/buyersguide/locale/pt_BR/LC_MESSAGES/django.*
[[ -e ${ptSourceDjango} ]] && cp ${ptSourceDjango} ${BUILD_DIR}/network-api/networkapi/buyersguide/locale/pt/LC_MESSAGES/django.*

# Same for Mozfest
ptSourceMozfest=${BUILD_DIR}/network-api/networkapi/mozfest/locale/pt_BR/LC_MESSAGES/django.*
[[ -e ${ptSourceDjango} ]] && cp ${ptSourceDjango} ${BUILD_DIR}/network-api/networkapi/mozfest/locale/pt/LC_MESSAGES/django.*
