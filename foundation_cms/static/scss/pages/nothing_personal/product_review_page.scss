@use "sass:map";
@use "sass:math";

@import "../../nothing_personal_base";
@import "../../components/nothing_personal/related_content";

html:has(body.nothing-personal.nothing-personal-product-review-page) {
  scroll-behavior: smooth;
}

body.nothing-personal.nothing-personal-product-review-page {
  [id] {
    scroll-margin-top: 100px;
  }

  main {
    h2 {
      @include mofo-text-style($header-styles, "h3", $header-font-family);
    }
  }

  .intro-section {
    $intro-subsection-margin-y: (
      small: rem-calc(16),
      large: rem-calc(24),
    );

    margin-top: 4rem;
    margin-bottom: rem-calc(80);

    @mixin responsive-spacing-y($margin-map) {
      margin-top: map.get($margin-map, small);
      margin-bottom: map.get($margin-map, small);

      @include breakpoint(large up) {
        margin-top: map.get($margin-map, large);
        margin-bottom: map.get($margin-map, large);
      }
    }

    .topic-pills,
    h1 {
      margin-bottom: map.get($intro-subsection-margin-y, small);

      @include breakpoint(large up) {
        margin-bottom: map.get($intro-subsection-margin-y, large);
      }
    }

    h1 {
      margin-top: 0;
    }

    > .grid-x {
      flex-direction: column-reverse;

      @include breakpoint(large up) {
        flex-direction: row;
      }
    }

    &__product-img {
      aspect-ratio: math.div(2, 3);
      overflow: hidden;
      margin-bottom: 4rem;

      @include breakpoint(large up) {
        margin-bottom: 0;
      }

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        display: block;
      }
    }

    &__meta {
      $gap: 1rem;

      @include mofo-text-style($header-styles, "h6", $header-font-family);
      @include responsive-spacing-y($intro-subsection-margin-y);

      display: flex;
      flex-wrap: wrap;

      &--small {
        @include mofo-text-style($body-text-styles, "small");
      }

      &-item {
        display: flex;
        align-items: baseline;

        &:not(:last-child) {
          &::after {
            content: "|";
            display: inline-block;
            margin-left: $gap;
            margin-right: $gap;
          }
        }

        dt {
          display: inline-block;

          &::after {
            content: ":\00a0";
          }
        }

        dd {
          display: inline-block;
          margin: 0;
        }

        &--primary {
          dt,
          dd {
            font-weight: bolder;
          }
        }
      }
    }

    &__lede-text {
      @include mofo-text-style($body-text-styles, "large");
      @include responsive-spacing-y($intro-subsection-margin-y);
    }

    &__details-box {
      background: color(neutral, "100");
      padding: 1.5rem 2rem;
      margin: 2rem 0;
      border-top-right-radius: rem-calc(48);
      display: flex;
      flex-direction: column;
      gap: 1rem;

      @include breakpoint(large up) {
        flex-direction: row;
        gap: 1.5rem;
      }
    }

    &__scoring {
      @include mofo-text-style($header-styles, "h6", $header-font-family);

      margin: 0;

      @include breakpoint(large up) {
        width: fit-content;
      }
    }

    &__details-text {
      @include breakpoint(large up) {
        flex: 1 1 0%;
      }
    }

    &__byline {
      @include mofo-text-style($body-text-styles, "large");

      font-weight: 700 !important;
    }

    &__details-meta {
      display: inline-block;
      margin: 0.5rem 0;

      .intro-section__meta-item {
        display: inline;
        align-items: baseline;
      }

      .intro-section__meta-item:not(:last-child)::after {
        margin: 0 0.5rem;
      }

      dt,
      dd {
        display: inline;
        margin: 0;
      }
    }

    &__who-am-i {
      @include mofo-text-style($body-text-styles, "small");

      transition: all 0.3s ease-out;
      max-height: 0;
      will-change: max-height;
      overflow: hidden;

      p:first-child {
        margin-top: 0;
      }
    }

    &__toc-nav {
      margin-top: 2rem;

      &-heading {
        @include mofo-text-style($label-text-styles, "regular");
        @include responsive-spacing-y($intro-subsection-margin-y);

        text-transform: uppercase;
      }

      &-list {
        display: grid;
        grid-template-columns: 1fr;
        row-gap: map.get($intro-subsection-margin-y, small);
        list-style: none;
        padding: 0;
        margin: 0;

        @include breakpoint(large up) {
          row-gap: map.get($intro-subsection-margin-y, large);
          grid-template-columns: 1fr 1fr;
        }
      }
    }

    &__details-box a,
    &__toc-nav-item a {
      @include link-text-color(
        map.get($mofo-colors, black),
        color(orange, "600")
      );
    }
  }

  .product-review-section a {
    @include link-text-color(
      map.get($mofo-colors, black),
      color(orange, "600")
    );
  }

  .products-mentioned {
    &__heading {
      @include mofo-text-style($header-styles, "h6", $header-font-family);

      margin-top: 0;
      margin-bottom: 0.5rem;

      @include breakpoint(large up) {
        margin-bottom: 1rem;
      }
    }

    ul {
      display: grid;
      grid-template-columns: 1fr 1fr;
      column-gap: 1rem;
      row-gap: 0.5rem;
      list-style: none;
      padding: 0;
      margin: 0;

      @include breakpoint(large up) {
        grid-template-columns: 1fr 1fr 1fr 1fr;
        row-gap: 0;
      }

      a {
        @include link-text-hover-underline;

        display: block;
      }
    }

    &__image-container {
      @include image-hover-zoom;

      aspect-ratio: math.div(2, 3);

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }
    }

    &__product-title {
      @include mofo-text-style($body-text-styles, "xlarge");

      display: block;
      margin-top: 0.5rem;
      color: map.get($mofo-colors, black);

      @include breakpoint(large up) {
        margin-top: 1rem;
      }
    }
  }

  .more-content-container {
    margin-top: rem-calc(50);

    .related-content {
      .content-card {
        margin-bottom: 0;

        &__title {
          @include mofo-text-style($body-text-styles, "xlarge");

          a {
            @include link-text-hover-underline;
          }
        }
      }
    }
  }
}
