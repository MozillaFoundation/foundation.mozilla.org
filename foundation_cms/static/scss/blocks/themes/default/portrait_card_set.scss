@use "sass:map";

.portrait-card-set {
  $card-border-radius: 5.75rem;
  $rotate-pos: 3deg;
  $rotate-neg: -3deg;
  $cardset-colors: (
    1: color(blue, "300"),
    2: color(yellow, "300"),
    3: color(orange, "200"),
    4: color(green, "300"),
  );

  &__card-container {
    display: flex;
    flex-wrap: nowrap;
    gap: 1.5rem;
    overflow: hidden;
    max-width: 100%;
    position: relative;
    scrollbar-width: none;
  }

  &__controls {
    display: flex;
    justify-content: end;
    margin-top: 1rem;

    @include breakpoint(large up) {
      display: none;
    }
  }

  &.is-carousel {
    @include breakpoint(large up) {
      .portrait-card {
        width: 30%;
      }

      .portrait-card-set__controls {
        display: flex;
      }
    }
  }

  // Carousel-specific track container
  .carousel-track {
    display: flex;
    width: 100%;
    will-change: transform;
    transition: transform 0.4s ease;
  }

  .portrait-card {
    color: inherit;
    text-decoration: none;
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    padding: 2.5rem 3rem 4.5rem;
    min-height: 29.25rem;
    aspect-ratio: math.div(5, 8);
    box-sizing: border-box;
    width: 80%; // Mobile default
    scroll-snap-align: start;

    @include breakpoint(medium) {
      width: 45%; // Tablet
    }

    @include breakpoint(large up) {
      width: calc(33.3333% - 1.3333rem);
      min-height: 44rem;
    }

    &:not(:last-child) {
      margin-right: 1.5rem;
    }

    &:last-child {
      margin-right: 0;
    }

    &__image {
      transition: transform 0.3s ease-out;
      aspect-ratio: math.div(1, 1);

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    }

    &__text {
      margin-top: auto;
    }

    &__headline {
      margin: 0;
      @include cta-link(map.get($cta-link-icon-sizes, xlarge), "xlarge");
      @include mofo-text-style($header-styles, "h4", $header-font-family);
    }

    &:hover {
      .portrait-card__image {
        transform: scale(1.05);
      }

      .portrait-card__headline::after {
        transform: translateX(0.75rem);
      }
    }

    // Color theming via data attribute
    @for $i from 1 through 4 {
      &[data-card-color="#{$i - 1}"] {
        background-color: map.get($cardset-colors, $i);

        .portrait-card__image img {
          @if $i == 1 {
            border-radius: 0 $card-border-radius 0 0;
            transform: rotate($rotate-neg);
          } @else if $i == 2 {
            border-radius: 0 $card-border-radius $card-border-radius 0;
            transform: rotate($rotate-pos);
          } @else if $i == 3 {
            border-radius: $card-border-radius $card-border-radius 0 0;
            transform: rotate($rotate-neg);
          } @else if $i == 4 {
            border-radius: 0 $card-border-radius 0 $card-border-radius;
            transform: rotate($rotate-pos);
          }
        }
      }
    }
  }
}
