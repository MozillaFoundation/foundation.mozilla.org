{% load wagtailimages_tags wagtailcore_tags i18n l10n responsive_image_tags %}

<div class="related-content">
    <h3 class="related-content__heading">{{ heading }}</h3>

    <div class="related-content__card-grid" {% if items_per_row %}style="--items-per-row: {{ items_per_row }}"{% endif %}>

        {% for item in items %}
            <div class="content-card">
                <a href="{% pageurl item %}" class="content-card__image-wrapper" style="--aspect-ratio: {% colon_to_slash image_ratio %}">
                    {% if image_field == "hero_image" and item.hero_image %}
                        {% responsive_image item.hero_image ratio=image_ratio %}
                    {% elif item.search_image %}
                        {% responsive_image item.search_image ratio=image_ratio %}
                    {% endif %}
                </a>
                <div class="content-card__topics">
                    {% with topics=item.topics.all %}
                        {% if topics %}
                            <ul>
                                {% for topic in topics %}
                                    <li><a class="btn-topic" href="{{ topic.get_topic_listing_url }}">{{ topic.name }}</a></li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    {% endwith %}
                </div>
                <div class="content-card__title"><a href="{% pageurl item %}">{{ item.title }}</a></div>
                {% if show_author != False and item.author %}
                    <div class="content-card__author-name">{% blocktrans with author=item.author.name %}By {{ author }}{% endblocktrans %}</div>
                {% endif %}
            </div>
        {% endfor %}
    </div>

</div>
