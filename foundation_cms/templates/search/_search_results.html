{% load wagtailcore_tags wagtailimages_tags responsive_image_tags i18n static %}

{% static 'foundation_cms/_images/fallbacks/listing-page-1.png' as listing_page_fallback_1 %}
{% static 'foundation_cms/_images/fallbacks/listing-page-2.png' as listing_page_fallback_2 %}
{% static 'foundation_cms/_images/fallbacks/listing-page-3.png' as listing_page_fallback_3 %}
{% static 'foundation_cms/_images/fallbacks/listing-page-4.png' as listing_page_fallback_4 %}
{% static 'foundation_cms/_images/fallbacks/listing-page-5.png' as listing_page_fallback_5 %}
{% static 'foundation_cms/_images/fallbacks/listing-page-6.png' as listing_page_fallback_6 %}

<ul class="search-results cell small-12">
  {% for result in search_results %}
    <li class="search-results__item">
      <article class="grid-x grid-margin-x page-card">
        <div class="cell small-12 medium-4 page-card__media-wrapper">
          <a href="{% pageurl result %}" class="page-card__image-wrapper">
            {% if result.specific.search_image %}
              {% responsive_image result.specific.search_image ratio="3:2" base_width=600 sizes="(max-width: 639px) 100vw, 33vw" %}
            {% else %}
              <img
                src="{% cycle listing_page_fallback_1 listing_page_fallback_2 listing_page_fallback_3 listing_page_fallback_4 listing_page_fallback_5 listing_page_fallback_6 %}"
                alt='{% translate "Illustration placeholder" %}'
                width="600"
                height="400"
              />
            {% endif %}
          </a>
        </div>
        <div class="cell small-12 medium-8 page-card__meta-wrapper">
          <div class="page-card__meta">
            {% comment %} Comment out the tag pill buttons for now because of https://mozilla-hub.atlassian.net/browse/TP1-3655 {% endcomment %}
            {% comment %}
            <div class="page-card__tags">
              {% include "patterns/components/topic_pills.html" with topics=result.specific.topics.all %}
            </div>
            {% endcomment %}
            <h3 class="page-card__title"><a href="{% pageurl result %}">{{ result.title }}</a></h3>
            {% if result.specific.authors.all %}
              {% spaceless %}
                <span class="page-card__author">
                  {% translate "By" context "Byline prefix" %}
                  {% for author in result.specific.authors.all %}
                    {% firstof author.name author.author_profile.name author as author_name %}
                    {% if author_name %}
                      {{ author_name }}{% if not forloop.last %}, {% endif %}
                    {% endif %}
                  {% endfor %}
                </span>
              {% endspaceless %}
            {% elif result.specific.author %}
              <span class="page-card__author">{% translate "By" context "Byline prefix" %} {{ result.specific.author.name }}</span>
            {% endif %}
            {% if result.first_published_at %}
              <span class="page-card__date">{{ result.first_published_at|date:"DATE_FORMAT" }}</span>
            {% endif %}
            <p class="page-card__description">{{ result.search_description }}</p>
          </div>
        </div>
      </article>
    </li>
  {% endfor %}
</ul>
