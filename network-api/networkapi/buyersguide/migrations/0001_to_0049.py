# Generated by Django 2.2.12 on 2020-06-04 23:28

import cloudinary.models
import django.core.validators
import django.db.migrations.operations.special
import django.db.models.deletion
import django.utils.timezone

from django.db import migrations, models
from django.template.defaultfilters import slugify

import modelcluster.fields

import networkapi.buyersguide.fields
import networkapi.buyersguide.pagemodels.cloudinary_image_field
import networkapi.buyersguide.pagemodels.get_product_image_upload_path
import networkapi.buyersguide.utils
import networkapi.buyersguide.validators


def create_default_categories(apps, schema_editor):
    BuyersGuideProductCategory = apps.get_model("buyersguide", "BuyersGuideProductCategory")
    categories = [
        "Toys & Games",
        "Smart Home",
        "Entertainment",
        "Wearables",
        "Health & Exercise",
        "Pets",
        "Valentine's Day",
        "Video Call Apps",
    ]

    for cat in categories:
        category, created = BuyersGuideProductCategory.objects.get_or_create(name=cat)
        if created:
            category.slug = slugify(cat)
            category.save()


class Migration(migrations.Migration):
    replaces = [
        ('buyersguide', '0001_initial'),
        ('buyersguide', '0002_auto_20180910_2037'),
        ('buyersguide', '0003_auto_20180927_2052'),
        ('buyersguide', '0004_auto_20181002_1659'),
        ('buyersguide', '0005_auto_20181002_1841'),
        ('buyersguide', '0006_add_product_categories'),
        ('buyersguide', '0007_auto_20181012_2045'),
        ('buyersguide', '0008_product_slug'),
        ('buyersguide', '0009_auto_20181018_2047'),
        ('buyersguide', '0010_auto_20181018_2053'),
        ('buyersguide', '0011_auto_20181023_0005'),
        ('buyersguide', '0012_auto_20181023_1828'),
        ('buyersguide', '0013_auto_20181023_2245'),
        ('buyersguide', '0014_auto_20181029_2109'),
        ('buyersguide', '0015_product_cloudinary_image'),
        ('buyersguide', '0016_auto_20181107_1421'),
        ('buyersguide', '0017_auto_20181114_2112'),
        ('buyersguide', '0018_product_is_draft'),
        ('buyersguide', '0019_auto_20190131_2039'),
        ('buyersguide', '0020_category_slugs'),
        ('buyersguide', '0021_buyersguideproductcategory_hidden'),
        ('buyersguide', '0022_product_review_date'),
        ('buyersguide', '0023_auto_20190917_2049'),
        ('buyersguide', '0024_update_product_fields_2019'),
        ('buyersguide', '0025_bootstrap_user_friendly_privacy_policy'),
        ('buyersguide', '0026_productprivacypolicylink'),
        ('buyersguide', '0027_null_boolean_field'),
        ('buyersguide', '0028_uplift_tri_to_quadstate'),
        ('buyersguide', '0029_auto_20191016_1759'),
        ('buyersguide', '0030_product_parental_controls_temp'),
        ('buyersguide', '0031_auto_20191016_2002'),
        ('buyersguide', '0032_product_user_friendly_privacy_policy_helptext'),
        ('buyersguide', '0033_uplift_app_device_fields'),
        ('buyersguide', '0034_auto_20200113_1514'),
        ('buyersguide', '0035_baseproduct_generalproduct'),
        ('buyersguide', '0036_migrate_to_new_product_hierarchy'),
        ('buyersguide', '0037_auto_20200414_1825'),
        ('buyersguide', '0038_basebooleanproductvote_basebooleanvote_basebooleanvotebreakdown_baserangeproductvote_baserangevote_b'),
        ('buyersguide', '0039_migrate_product_voting'),
        ('buyersguide', '0040_auto_20200415_1933'),
        ('buyersguide', '0041_auto_20200415_2255'),
        ('buyersguide', '0042_auto_20200416_1946'),
        ('buyersguide', '0043_deduplication_pass'),
        ('buyersguide', '0044_auto_20200423_2250'),
        ('buyersguide', '0045_auto_20200424_1800'),
        ('buyersguide', '0046_auto_20200427_2322'),
        ('buyersguide', '0047_auto_20200506_1918'),
        ('buyersguide', '0048_auto_20200507_1619'),
        ('buyersguide', '0049_auto_20200511_1820'),
    ]

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='BooleanProductVote',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('votes', models.IntegerField(default=0)),
                ('attribute', models.CharField(max_length=100, validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=['confidence'])])),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='BuyersGuideProductCategory',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, help_text='Description of the product category. Max. 300 characters.', max_length=300)),
                ('featured', models.BooleanField(default=False, help_text="Featured category will appear first on Buyer's Guide site nav")),
                ('hidden', models.BooleanField(default=False, help_text="Hidden categories will not appear in the Buyer's Guide site nav at all")),
                ('slug', models.SlugField(blank=True, help_text='A URL-friendly version of the product name. This is an auto-generated field.')),
            ],
            options={
                'verbose_name': 'Buyers Guide Product Category',
                'verbose_name_plural': 'Buyers Guide Product Categories',
            },
        ),
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('draft', models.BooleanField(default=True, help_text='When checked, this product will only show for CMS-authenticated users')),
                ('adult_content', models.BooleanField(default=False, help_text='When checked, product thumbnail will appear blurred as well as have an 18+ badge on it')),
                ('review_date', models.DateField(help_text='Review date of this product')),
                ('name', models.CharField(blank=True, help_text='Name of Product', max_length=100)),
                ('slug', models.CharField(blank=True, default=None, editable=False, help_text='slug used in urls', max_length=256)),
                ('company', models.CharField(blank=True, help_text='Name of Company', max_length=100)),
                ('blurb', models.TextField(blank=True, help_text='Description of the product', max_length=5000)),
                ('url', models.URLField(blank=True, help_text='Link to this product page', max_length=2048)),
                ('price', models.CharField(blank=True, help_text='Price', max_length=100)),
                ('image', models.FileField(blank=True, help_text='Image representing this product', max_length=2048, upload_to=networkapi.buyersguide.pagemodels.get_product_image_upload_path.get_product_image_upload_path)),
                ('cloudinary_image', cloudinary.models.CloudinaryField(blank=True, help_text='Image representing this product - hosted on Cloudinary', max_length=255, verbose_name='image')),
                ('meets_minimum_security_standards', models.BooleanField(help_text='Does this product meet minimum security standards?', null=True)),
                ('uses_encryption', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does the product use encryption?')),
                ('uses_encryption_helptext', models.TextField(blank=True, max_length=5000)),
                ('security_updates', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Security updates?')),
                ('security_updates_helptext', models.TextField(blank=True, max_length=5000)),
                ('strong_password', networkapi.buyersguide.fields.ExtendedYesNoField()),
                ('strong_password_helptext', models.TextField(blank=True, max_length=5000)),
                ('manage_vulnerabilities', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Manages security vulnerabilities?')),
                ('manage_vulnerabilities_helptext', models.TextField(blank=True, max_length=5000)),
                ('privacy_policy', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this product have a privacy policy?')),
                ('privacy_policy_helptext', models.TextField(blank=True, max_length=5000)),
                ('share_data', models.BooleanField(help_text='Does the maker share data with other companies?', null=True)),
                ('share_data_helptext', models.TextField(blank=True, max_length=5000)),
                ('how_does_it_share', models.CharField(blank=True, help_text='How does this product handle data?', max_length=5000)),
                ('user_friendly_privacy_policy', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this product have a user-friendly privacy policy?')),
                ('user_friendly_privacy_policy_helptext', models.TextField(blank=True, max_length=5000)),
                ('worst_case', models.CharField(blank=True, help_text="What's the worst thing that could happen by using this product?", max_length=5000)),
                ('phone_number', models.CharField(blank=True, help_text='Phone Number', max_length=100)),
                ('live_chat', models.CharField(blank=True, help_text='Live Chat', max_length=100)),
                ('email', models.CharField(blank=True, help_text='Email', max_length=100)),
                ('twitter', models.CharField(blank=True, help_text='Twitter username', max_length=100)),
                ('product_category', models.ManyToManyField(blank=True, related_name='pniproduct', to='buyersguide.BuyersGuideProductCategory')),
                ('related_products', models.ManyToManyField(blank=True, related_name='related_pniproduct', to='buyersguide.Product')),
            ],
            options={
                'ordering': ['id'],
            },
        ),
        migrations.CreateModel(
            name='RangeProductVote',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('votes', models.IntegerField(default=0)),
                ('attribute', models.CharField(max_length=100, validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=['creepiness'])])),
                ('average', models.IntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)])),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='range_product_votes', to='buyersguide.Product')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Update',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('source', models.URLField(help_text='Link to source', max_length=2048)),
                ('title', models.CharField(max_length=256)),
                ('author', models.CharField(blank=True, max_length=256)),
                ('featured', models.BooleanField(default=False, help_text='feature this update at the top of the list?')),
                ('snippet', models.TextField(blank=True, max_length=5000)),
            ],
        ),
        migrations.CreateModel(
            name='GeneralProduct',
            fields=[
                ('product_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='buyersguide.Product')),
                ('camera_device', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this device have or access a camera?')),
                ('camera_app', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does the app have or access a camera?')),
                ('microphone_device', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this Device have or access a microphone?')),
                ('microphone_app', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this app have or access a microphone?')),
                ('location_device', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this product access your location?')),
                ('location_app', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this app access your location?')),
                ('delete_data', models.BooleanField(help_text='Can you request data be deleted?', null=True)),
                ('delete_data_helptext', models.TextField(blank=True, max_length=5000)),
                ('parental_controls', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Are there rules for children?', null=True)),
                ('child_rules_helptext', models.TextField(blank=True, max_length=5000)),
                ('collects_biometrics', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Does this product collect biometric data?')),
                ('collects_biometrics_helptext', models.TextField(blank=True, max_length=5000)),
            ],
            options={
                'abstract': False,
            },
            bases=('buyersguide.product',),
        ),
        migrations.CreateModel(
            name='SoftwareProduct',
            fields=[
                ('product_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='buyersguide.Product')),
                ('handles_recordings_how', models.TextField(blank=True, help_text='How does this software handle your recordings', max_length=5000)),
                ('recording_alert', networkapi.buyersguide.fields.ExtendedYesNoField(help_text='Alerts when calls are being recorded?', null=True)),
                ('recording_alert_helptext', models.TextField(blank=True, max_length=5000)),
                ('signup_with_email', models.BooleanField(help_text='Email required to sign up?', null=True)),
                ('signup_with_phone', models.BooleanField(help_text='Phone number required to sign up?', null=True)),
                ('signup_with_third_party', models.BooleanField(help_text='Third Party account required to sign up?', null=True)),
                ('signup_methods_helptext', models.TextField(blank=True, help_text='Describe the kind of contact information requirements for signing up for this product', max_length=5000)),
                ('medical_privacy_compliant', models.BooleanField(help_text='Compliant with US medical privacy laws?', null=True)),
                ('medical_privacy_compliant_helptext', models.TextField(blank=True, max_length=5000)),
                ('host_controls', models.TextField(blank=True, max_length=5000)),
                ('easy_to_learn_and_use', models.BooleanField(help_text='Is it easy to learn & use the features?', null=True)),
                ('easy_to_learn_and_use_helptext', models.TextField(blank=True, max_length=5000)),
            ],
            options={
                'abstract': False,
            },
            bases=('buyersguide.product',),
        ),
        migrations.CreateModel(
            name='RangeVoteBreakdown',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('count', models.IntegerField(default=0)),
                ('bucket', models.IntegerField(validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=[0, 1, 2, 3, 4])])),
                ('product_vote', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='buyersguide.RangeProductVote')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='RangeVote',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('attribute', models.CharField(max_length=100, validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=['creepiness'])])),
                ('value', models.IntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)])),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='buyersguide.Product')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ProductPrivacyPolicyLink',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('sort_order', models.IntegerField(blank=True, editable=False, null=True)),
                ('label', models.CharField(help_text='Label for this link on the product page', max_length=500)),
                ('url', models.URLField(blank=True, help_text='Privacy policy URL', max_length=2048)),
                ('product', modelcluster.fields.ParentalKey(on_delete=django.db.models.deletion.CASCADE, related_name='privacy_policy_links', to='buyersguide.Product')),
            ],
            options={
                'verbose_name': 'Buyers Guide Product Privacy Policy link',
                'verbose_name_plural': 'Buyers Guide Product Privacy Policy links',
            },
        ),
        migrations.AddField(
            model_name='product',
            name='updates',
            field=models.ManyToManyField(blank=True, related_name='pniproduct', to='buyersguide.Update'),
        ),
        migrations.CreateModel(
            name='BooleanVoteBreakdown',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('count', models.IntegerField(default=0)),
                ('bucket', models.IntegerField(validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=[0, 1])])),
                ('product_vote', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='buyersguide.BooleanProductVote')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='BooleanVote',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('attribute', models.CharField(max_length=100, validators=[networkapi.buyersguide.validators.ValueListValidator(valid_values=['confidence'])])),
                ('value', models.BooleanField()),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='buyersguide.Product')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AddField(
            model_name='booleanproductvote',
            name='product',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='boolean_product_votes', to='buyersguide.Product'),
        ),

        migrations.RunPython(create_default_categories),
    ]
