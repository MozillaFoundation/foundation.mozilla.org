{% extends "pages/buyersguide/catalog.html" %}
{% load static i18n wagtailcore_tags %}

{% block body_id %}{{ category.slug }}{% endblock %}

{% block guts %}
  {% for category in categories  %}
    {% with primary_related_articles=category.get_primary_related_articles  %}
      {% comment %}
        JS needs to handle the visibility switch for the related articles from one to the other category.
      {% endcomment %}
      {% if primary_related_articles %}
        <div
          class="
            {% if category != current_category %}
              d-none
            {% endif %}
          "
        >
          <h2>({{ category.name }}) Primary related articles (First 3 of list of 6)</h2>

          <ul>
            {% for article in primary_related_articles %}
              <li><a href="{% pageurl article %}">{{ article.title }}</a></li>
            {% endfor %}
          </ul>
          <div>
            <a href="{% pageurl page.get_editorial_content_index %}">All articles</a>
          </div>
          {% if category.show_cta %}
            {% with cta=featured_cta %}
              {% if cta %}
                <div>
                  <h2> Call to Action: </h2>
                  <p> <b>Title:</b> {{ cta.title }} </p>
                  <p> <b>Sticker Image:</b> {{ cta.sticker_image }} </p>
                  <p> <b> Content: </b> </p>
                  {{ cta.content|richtext }}
                  <p> <b>Link Label: </b> {{cta.link_label }} </p>
                  <p> <b> Link Target: </b> {{cta.get_target_url }} </p>
                </div>
              {% endif %}
            {% endwith %}
          {% endif %}
        </div>
      {% endif %}
    {% endwith %}
  {% endfor %}

  {{ block.super }}

  {% for category in categories  %}
    {% with secondary_related_articles=category.get_secondary_related_articles  %}
      {% comment %}
        JS needs to handle the visibility switch for the related articles from one to the other category.
      {% endcomment %}
      {% if secondary_related_articles %}
        <div
          class="
            {% if category != current_category %}
              d-none
            {% endif %}
          "
        >
          <h2>({{ category.name }}) Secondary related articles (First 3 of list of 6)</h2>

          <ul>
            {% for article in secondary_related_articles %}
              <li><a href="{% pageurl article %}">{{ article.title }}</a></li>
            {% endfor %}
          </ul>
          <div>
            <a href="{% pageurl page.get_editorial_content_index %}">All articles</a>
          </div>
        </div>
      {% endif %}
    {% endwith %}
  {% endfor %}

{% endblock guts %}
