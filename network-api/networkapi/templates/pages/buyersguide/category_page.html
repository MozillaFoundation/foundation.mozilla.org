{% extends "pages/buyersguide/catalog.html" %}
{% load static i18n wagtailcore_tags %}

{% block body_id %}{{ category.slug }}{% endblock %}

{% block guts %}
  {% with editorial_content_index=page.get_editorial_content_index  %}
    {% for category in categories  %}
      {% with primary_related_articles=category.get_primary_related_articles  %}
        {% comment %}
          JS needs to handle the visibility switch for the related articles from one to the other category.
        {% endcomment %}
        {% if primary_related_articles %}
          <div
            class="
              {% if category != current_category %}
                d-none
              {% endif %}
            "
          >
            <h2>({{ category.name }}) Primary related articles (First 3 of list of 6)</h2>

            <div class="tw-m-4">
              {% include "fragments/buyersguide/related_reading.html" with articles=primary_related_articles index_page=editorial_content_index %}
            </div>

          </div>
        {% endif %}
      {% endwith %}
    {% endfor %}

    {{ block.super }}

    {% for category in categories  %}
      {% with secondary_related_articles=category.get_secondary_related_articles  %}
        {% comment %}
          JS needs to handle the visibility switch for the related articles from one to the other category.
        {% endcomment %}
        {% if secondary_related_articles %}
          <div
            class="
              {% if category != current_category %}
                tw-hidden
              {% endif %}
              tw-container
              tw-my-7
            "
          >
            {% trans "What to read next" as heading %}
            {% include "fragments/buyersguide/article_listing_compact.html" with heading=heading articles=secondary_related_articles index_page=editorial_content_index show_images=True %}
          </div>
        {% endif %}
      {% endwith %}
    {% endfor %}
  {% endwith %}
{% endblock guts %}
